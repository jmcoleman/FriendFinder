<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<title>FriendFinder</title>

		<!-- Bootstrap 5.1.3 -->
		<link
			rel="stylesheet"
			href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.1.3/css/bootstrap.min.css"
			integrity="sha512-GQGU0fMMi238uA+a/bdWJfpUGKUkBdgfFdgBm72SUQ6BeyWjoY/ton0tEjH+OSH9iP4Dfh+7HM0I9f5eR0L/4w=="
			crossorigin="anonymous"
			referrerpolicy="no-referrer"
		/>

		<!-- Font Awesome -->
		<link
			rel="stylesheet"
			href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
			integrity="sha512-Fo3rlrZj/k7ujTnHg4CGR2D7kSs0v4LLanw2qksYuRlEzO+tcaEPQogQ0KaoGN26/zrn20ImR1DfuLWnOo7aBA=="
			crossorigin="anonymous"
			referrerpolicy="no-referrer"
		/>

		<!-- Fonts -->
		<link rel="preconnect" href="https://fonts.googleapis.com" />
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
		<link
			href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@300;400&display=swap"
			rel="stylesheet"
		/>

		<style>
			:root {
				--color-light: #caf0f8;
				--color-dark: #303036;
				--bg-color-light: #ade8f4;
				--bg-color-dark: #303036;
			}

			body {
				font-family: 'Open Sans', sans-serif;
				font-weight: 400;
			}

			h2 {
				font-weight: 300;
			}
		</style>
	</head>

	<body>
		<div class="container">
			<h2>Survey Questions</h2>
			<hr />

			<h3><strong>About You</strong></h3>
			<h4>Name (Required)</h4>
			<input type="text" id="name" class="form-control" required />

			<h4>Link to Photo Image (Required)</h4>
			<input type="text" id="photo" class="form-control" required />

			<hr />

			<h3><strong>Question 1</strong></h3>
			<h4>Your mind is always buzzing with unexplored ideas and plans.</h4>
			<select class="chosen-select" id="q1">
				<option value=""></option>
				<option value="1">1 (Strongly Disagree)</option>
				<option value="2">2</option>
				<option value="3">3</option>
				<option value="4">4</option>
				<option value="5">5 (Strongly Agree)</option>
			</select>

			<h3><strong>Question 2</strong></h3>
			<h4>
				Generally speaking, you rely more on your experience than your
				imagination.
			</h4>
			<select class="chosen-select" id="q2">
				<option value=""></option>
				<option value="1">1 (Strongly Disagree)</option>
				<option value="2">2</option>
				<option value="3">3</option>
				<option value="4">4</option>
				<option value="5">5 (Strongly Agree)</option>
			</select>

			<h3><strong>Question 3</strong></h3>
			<h4>
				You find it easy to stay relaxed and focused even when there is some
				pressure.
			</h4>
			<select class="chosen-select" id="q3">
				<option value=""></option>
				<option value="1">1 (Strongly Disagree)</option>
				<option value="2">2</option>
				<option value="3">3</option>
				<option value="4">4</option>
				<option value="5">5 (Strongly Agree)</option>
			</select>

			<h3><strong>Question 4</strong></h3>
			<h4>You rarely do something just out of sheer curiosity.</h4>
			<select class="chosen-select" id="q4">
				<option value=""></option>
				<option value="1">1 (Strongly Disagree)</option>
				<option value="2">2</option>
				<option value="3">3</option>
				<option value="4">4</option>
				<option value="5">5 (Strongly Agree)</option>
			</select>

			<h3><strong>Question 5</strong></h3>
			<h4>People can rarely upset you.</h4>
			<select class="chosen-select" id="q5">
				<option value=""></option>
				<option value="1">1 (Strongly Disagree)</option>
				<option value="2">2</option>
				<option value="3">3</option>
				<option value="4">4</option>
				<option value="5">5 (Strongly Agree)</option>
			</select>

			<h3><strong>Question 6</strong></h3>
			<h4>
				It is often difficult for you to relate to other people’s feelings.
			</h4>
			<select class="chosen-select" id="q6">
				<option value=""></option>
				<option value="1">1 (Strongly Disagree)</option>
				<option value="2">2</option>
				<option value="3">3</option>
				<option value="4">4</option>
				<option value="5">5 (Strongly Agree)</option>
			</select>

			<h3><strong>Question 7</strong></h3>
			<h4>
				In a discussion, truth should be more important than people’s
				sensitivities.
			</h4>
			<select class="chosen-select" id="q7">
				<option value=""></option>
				<option value="1">1 (Strongly Disagree)</option>
				<option value="2">2</option>
				<option value="3">3</option>
				<option value="4">4</option>
				<option value="5">5 (Strongly Agree)</option>
			</select>

			<h3><strong>Question 8</strong></h3>
			<h4>You rarely get carried away by fantasies and ideas.</h4>
			<select class="chosen-select" id="q8">
				<option value=""></option>
				<option value="1">1 (Strongly Disagree)</option>
				<option value="2">2</option>
				<option value="3">3</option>
				<option value="4">4</option>
				<option value="5">5 (Strongly Agree)</option>
			</select>

			<h3><strong>Question 9</strong></h3>
			<h4>
				You think that everyone’s views should be respected regardless of
				whether they are supported by facts or not.
			</h4>
			<select class="chosen-select" id="q9">
				<option value=""></option>
				<option value="1">1 (Strongly Disagree)</option>
				<option value="2">2</option>
				<option value="3">3</option>
				<option value="4">4</option>
				<option value="5">5 (Strongly Agree)</option>
			</select>

			<h3><strong>Question 10</strong></h3>
			<h4>
				You feel more energetic after spending time with a group of people.
			</h4>
			<select class="chosen-select" id="q10">
				<option value=""></option>
				<option value="1">1 (Strongly Disagree)</option>
				<option value="2">2</option>
				<option value="3">3</option>
				<option value="4">4</option>
				<option value="5">5 (Strongly Agree)</option>
			</select>

			<br />
			<br />

			<!-- Submit Button -->
			<button
				type="submit"
				class="btn btn-lg btn-block"
				id="submit"
				style="background-color: var(--color-dark); color: white"
			>
				<i class="far fa-check-circle"></i>
				Submit
			</button>

			<hr />
			<footer class="footer">
				<div class="container">
					<p>
						<a style="color: var(--color-dark)" href="/api/friends"
							>API Friends List</a
						>
						|
						<a
							style="color: var(--color-dark)"
							href="https://github.com/jmcoleman/friendfinder"
							>GitHub Repo</a
						>
					</p>
				</div>
			</footer>
		</div>

		<!-- Modal -->
		<div id="results-modal" class="modal fade" role="dialog">
			<div class="modal-dialog">
				<!-- Modal content-->
				<div class="modal-content">
					<div class="modal-header">
						<button type="button" class="close" data-dismiss="modal">
							&times;
						</button>
						<h2 class="modal-title"><strong>Best Match</strong></h2>
					</div>
					<div class="modal-body">
						<h2 id="match-name"></h2>
						<img id="match-img" src="" alt="" />
					</div>
					<div class="modal-footer">
						<button type="button" class="btn btn-default" data-dismiss="modal">
							Close
						</button>
					</div>
				</div>
			</div>
		</div>

		<script type="text/javascript">
			// Chosen CSS
			var config = {
				'.chosen-select': {},
				'.chosen-select-deselect': {
					allow_single_deselect: true,
				},
				'.chosen-select-no-single': {
					disable_search_threshold: 10,
				},
				'.chosen-select-no-results': {
					no_results_text: 'Oops, nothing found!',
				},
				'.chosen-select-width': {
					width: '95%',
				},
			}

			for (var selector in config) {
				$(selector).chosen(config[selector])
			}

			// Capture the form inputs
			$('#submit').on('click', function (event) {
				event.preventDefault()

				// Form validation
				function validateForm() {
					var isValid = true

					$('.form-control').each(function () {
						if ($(this).val() === '') {
							isValid = false
						}
					})

					$('.chosen-select').each(function () {
						if ($(this).val() === '') {
							isValid = false
						}
					})
					return isValid
				}

				// If all required fields are filled
				if (validateForm()) {
					// Create an object for the user"s data
					var userData = {
						name: $('#name').val(),
						photo: $('#photo').val(),
						scores: [
							$('#q1').val(),
							$('#q2').val(),
							$('#q3').val(),
							$('#q4').val(),
							$('#q5').val(),
							$('#q6').val(),
							$('#q7').val(),
							$('#q8').val(),
							$('#q9').val(),
							$('#q10').val(),
						],
					}

					// AJAX post the data to the friends API.
					$.post('/api/friends', userData, function (data) {
						// Grab the result from the AJAX post so that the best match's name and photo are displayed.
						$('#match-name').text(data.name)
						$('#match-img').attr('src', data.photo)

						// Show the modal with the best match
						$('#results-modal').modal('toggle')
					})

					////////////////////////
					// clear the form
					////////////////////////
					$('.form-control').each(function () {
						this.value = ''
					})
					//clears all fields after submit similar to a form reset but for use with CHOOSEN
					$('.chosen-select').val('').trigger('chosen:updated')
				} else {
					alert('Please fill out all fields before submitting!')
				}
			})
		</script>
	</body>
</html>
